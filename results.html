<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pharmacy Store</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-image: url("tyl.jpg");
      background-blend-mode: lighten;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      padding-top: 100px; /* Add padding to prevent content from overlapping the fixed header */
    }

    header {
      background: linear-gradient(rgb(51, 129, 194), rgb(255, 255, 255));
      color: rgb(0, 0, 0);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: fixed; /* Make the header fixed */
      top: 0; /* Position it at the top of the viewport */
      width: 100%; /* Ensure it spans the full width */
      z-index: 1000; /* Ensure it stays above other elements */
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .logo {
      width: 60px;
      height: 60px;
      margin-right: 15px;
    }

    .header-text h1 {
      margin: 0;
      font-weight: bold;
    }

    .top-right-buttons button {
      margin-left: 10px;
      padding: 10px 20px;
      font-size: 16px;
      background-color: white;
      color: rgb(51, 129, 194);
      border: 1px solid rgb(51, 129, 194);
      border-radius: 5px;
      cursor: pointer;
    }

    .zip-code-display {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin: 20px 0;
      color: rgb(51, 129, 194);
    }

    .search-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 20px auto;
    }

    .search-bar input {
      width: 60%;
      max-width: 700px;
      padding: 15px;
      font-size: 16px;
      border: 2px solid rgb(51, 129, 194);
      border-radius: 5px;
      outline: none;
    }

    .search-bar button {
      margin-left: 10px;
      padding: 10px 20px;
      font-size: 16px;
      background-color: rgb(51, 129, 194);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .search-bar img {
    display: flex;
    width: 60px; /* Adjust the width to make the image smaller */
    height: 60px; /* Adjust the height to maintain aspect ratio */
    margin-left: 10px; /* Move the image slightly to the left */
    cursor: pointer; /* Ensure the cursor changes to a pointer on hover */
  }
    .results-container {
      width: 90%;
      margin: 20px auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .result-rectangle {
      width: 800px;
      height: 200px;
      background-image: url("C:/Users/isras/OneDrive/Desktop/Bellevue College/Spring 2025/CS 410 Software engineering/Final/tyl.jpeg");
      background-size: cover; /* Ensures the image covers the entire rectangle */
      background-position: center; /* Centers the image */
      background-repeat: no-repeat; /* Prevents the image from repeating */
      border: 2px solid rgb(44, 42, 215);
      border-radius: 10px;
      position: relative;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .store-box img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      border-radius: 5px;
    }

    .store-box {
      position: absolute;
      top: 50%;
      left: 10px;
      transform: translateY(-50%);
      font-weight: bold;
      color: rgb(44, 42, 215);
      border: 1px solid rgb(44, 42, 215);
      padding: 10px;
      background-color: #f9f9f9;
      border-radius: 5px;
    }

    .location-box {
      position: absolute;
      top: 50%;
      left: 75%;
      transform: translate(-50%, -50%);
      font-weight: bold;
      color: rgb(44, 42, 215);
      text-align: center;
    }

    .availability-box {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-weight: bold;
      color: green; /* Change color to green */
    }

    .search-bar img {
    width: 60px; /* Adjust the width to make the image smaller */
    height: 60px; /* Adjust the height to maintain aspect ratio */
    margin-left: -10px; /* Move the image slightly to the left */
    cursor: pointer; /* Ensure the cursor changes to a pointer on hover */
  }

    .medicine-box {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-weight: bold;
      color: rgb(44, 42, 215);
    }

    .price-box {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-weight: bold;
      color: rgb(44, 42, 215);
    }

    .infoto {
      position: absolute;
      top: 50%;
      left: 150px; /* Adjust this value to position the image horizontally */
      transform: translateY(-50%);
    }

    .infoto img {
      width: 180px; /* Set the width of the image */
      height: auto; /* Maintain aspect ratio */
      border-radius: 5px; /* Optional: Add rounded corners */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Optional: Add a shadow for better visibility */
    }

    .filter-popup {
      display: none;
      position: absolute;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      background-color: white;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      width: 300px;
    }

    .filter-popup h3 {
      margin-top: 0;
    }

    .filter-popup select,
    .filter-popup input[type="range"] {
      width: 100%;
      margin-bottom: 10px;
    }

    .filter-popup button {
      padding: 10px 20px;
      background-color: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .filter-icon {
      margin: 20px;
      padding: 10px 20px;
      background-color: rgb(64, 171, 221);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <img src="C:/Users/isras/OneDrive/Desktop/Bellevue College/Spring 2025/CS 410 Software engineering/Final/logo.png" alt="Logo" class="logo" onclick="goHome()">
      <div class="header-text">
        <h1>
          <img src="C:/Users/isras/OneDrive/Desktop/Bellevue College/Spring 2025/CS 410 Software engineering/Final/goods2go.jpg" alt="Goods2Go" class="logo">
        </h1>
      </div>
    </div>
    <div class="top-right-buttons">
      <button onclick="goHome()">üè† Home</button>
      <button onclick="window.location.href='bookmarks.html'">üîñ Bookmarks</button>
    </div>
  </header>

  <div class="zip-code-display">
    ZIP Code: <span id="zipCodeDisplay">N/A</span>
    <br>
    <input type="text" id="zipCodeInput" placeholder="Enter new ZIP Code" />
    <button onclick="changeZipCode()">Change ZIP Code</button>
  </div>

  <!-- Filter Popup -->
  <div class="filter-popup" id="filterPopup">
    <h3>Filters</h3>

    <!-- Store Selection -->
    <label>Choose Stores:</label>
    <div id="storeCheckboxes">
      <label><input type="checkbox" value="All" onchange="filterResults()"> All</label><br>
      <label><input type="checkbox" value="CVS" onchange="filterResults()"> CVS</label><br>
      <label><input type="checkbox" value="Fred Meyer" onchange="filterResults()"> Fred Meyer</label><br>
      <label><input type="checkbox" value="Qfc" onchange="filterResults()"> Qfc</label><br>
      <label><input type="checkbox" value="Safeway" onchange="filterResults()"> Safeway</label><br>
      <label><input type="checkbox" value="Target" onchange="filterResults()"> Target</label><br>
      <label><input type="checkbox" value="Walgreens" onchange="filterResults()"> Walgreens</label><br>
      <label><input type="checkbox" value="Walmart" onchange="filterResults()"> Walmart</label><br>
    </div>
    <br><br>

    <!-- Distance Range -->
    <label for="distanceRange">Distance Within (miles):</label>
    <input type="range" id="distanceRange" min="0" max="100" step="5" value="50" oninput="updateDistanceLabel(this.value)">
    <p>Selected Distance: <span id="distanceLabel">50</span> miles</p>
    <br>

    <!-- Price Range -->
    <label for="priceRangeMin">Price Range ($):</label>
    <input type="range" id="priceRangeMin" min="0" max="1000" step="10" value="0" oninput="updatePriceLabel()">
    <input type="range" id="priceRangeMax" min="0" max="1000" step="10" value="1000" oninput="updatePriceLabel()">
    <p>Selected Price: <span id="priceLabel">$0 - $1000</span></p>
    <br>

    <!-- Sorting Options -->
    <label for="sortBy">Sort By:</label>
    <select id="sortBy">
      <option value="none">None</option>
      <option value="price">Price</option>
      <option value="location">Location (ZIP Code)</option>
      <option value="both">Price & Location</option>
    </select>
    <br><br>

    <!-- Availability Filter -->
    <label><input type="checkbox" id="inStockOnly" onchange="applyFilters()"> In Stock Only</label>
    <br><br>

    <button onclick="applyFilters()">Apply Filters</button>
  </div>


  <div class="search-bar">
    <input type="text" id="searchInput" list="medicineSuggestions" placeholder="Search for your medicine or enter a code" />
    <datalist id="medicineSuggestions">
      <option value="Ibuprofen Extra Strength">
      <option value="Ibuprofen Cold & Flu Severe">
      <option value="Ibuprofen PM">
      <option value="iybuprofen Arthritis Pain">
    </datalist>
    <img src="https://img.icons8.com/?size=100&id=132&format=png&color=000000" alt="Search" onclick="handleSearch()" />
    <button onclick="handleSearch()">Search</button>
    <button class="filter-icon" onclick="toggleFilter()">‚ò∞ Filter</button>
  </div>


  <!-- Results Containers -->
  <div id="results"></div>

  <script>
    // Load the search query and ZIP code from localStorage and update the page
    window.onload = function () {
      const searchQuery = localStorage.getItem('searchQuery') || 'N/A';
      const zipCode = localStorage.getItem('zipCode') || 'N/A';

      // Update all medicine cells
      document.querySelectorAll('.medicineCell').forEach((cell) => {
        cell.textContent = searchQuery;
      });

      // Update the ZIP code display
      document.getElementById('zipCodeDisplay').textContent = zipCode;
    };

    // Redirect to the home page
    function goHome() {
      window.location.href = 'index1.html';
    }

    // Handle search
    function handleSearch() {
      const searchQuery = document.querySelector('.search-bar input').value.trim();
      localStorage.setItem('searchQuery', searchQuery);
      window.location.href = 'results.html';
    }

    // Toggle filter popup (placeholder function)
    function toggleFilter() {
      const filterPopup = document.getElementById('filterPopup');
      filterPopup.style.display = filterPopup.style.display === 'none' ? 'block' : 'none';
    }

    // Update distance label
    function updateDistanceLabel(value) {
      document.getElementById('distanceLabel').textContent = value;
    }

    // Update price label
    function updatePriceLabel() {
      const minPrice = document.getElementById('priceRangeMin').value;
      const maxPrice = document.getElementById('priceRangeMax').value;
      document.getElementById('priceLabel').textContent = `$${minPrice} - $${maxPrice}`;
    }

    // Apply filters (placeholder function)
    function applyFilters() {
      const checkboxes = document.querySelectorAll('#storeCheckboxes input[type="checkbox"]');
      const selectedStores = Array.from(checkboxes)
        .filter(checkbox => checkbox.checked && checkbox.value !== "All")
        .map(checkbox => checkbox.value);

      const minPrice = parseInt(document.getElementById('priceRangeMin').value, 10);
      const maxPrice = parseInt(document.getElementById('priceRangeMax').value, 10);
      const sortBy = document.getElementById('sortBy').value;
      const inStockOnly = document.getElementById('inStockOnly').checked;

      // Filter data based on selected stores, price range, and availability
      let filteredData = storeData.filter(store => {
        const price = parseFloat(store.price.replace('$', ''));
        const isInStock = !inStockOnly || store.availability === "In Stock";
        return (
          (selectedStores.length === 0 || selectedStores.includes(store.company)) &&
          price >= minPrice &&
          price <= maxPrice &&
          isInStock
        );
      });

      // Sort data based on the selected sorting option
      if (sortBy === 'price') {
        filteredData.sort((a, b) => parseFloat(a.price.replace('$', '')) - parseFloat(b.price.replace('$', '')));
      } else if (sortBy === 'location') {
        filteredData.sort((a, b) => parseInt(a.zip, 10) - parseInt(b.zip, 10));
      } else if (sortBy === 'both') {
        filteredData.sort((a, b) => {
          const priceDiff = parseFloat(a.price.replace('$', '')) - parseFloat(b.price.replace('$', ''));
          if (priceDiff !== 0) return priceDiff;
          return parseInt(a.zip, 10) - parseInt(b.zip, 10);
        });
      }

      // Generate results based on the filtered and sorted data
      generateResults(filteredData);
    }

    function handleSearch() {
      const searchQuery = document.querySelector('.search-bar input').value.trim().toLowerCase();
    if (searchQuery.includes("ibuprofen")) {
    localStorage.setItem('searchQuery', searchQuery);
    window.location.href = 'ireslt.html';
  } else {
    alert("Please enter a valid medicine name or code.");
  }
    }
    document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.querySelector('.search-bar input');
    searchInput.addEventListener('keydown', function (event) {
      if (event.key === 'Enter') {
        handleSearch();
      }
    });
  });

  // Function to change the ZIP code
  function changeZipCode() {
    const newZipCode = document.getElementById('zipCodeInput').value.trim();

    if (newZipCode) {
      // Update the ZIP code display
      document.getElementById('zipCodeDisplay').textContent = newZipCode;

      // Save the new ZIP code to localStorage
      localStorage.setItem('zipCode', newZipCode);

      alert(`ZIP Code updated to: ${newZipCode}`);
    } else {
      alert('Please enter a valid ZIP Code.');
    }
  }

  // Updated data for the container boxes with specific availability
  const storeData = [
    { company: "CVS", address: "10712 SE Carr Rd", city: "Renton", state: "WA", zip: "98055", price: "$5.99", image: "cvs.jpeg", availability: "In Stock" },
    { company: "CVS", address: "107 Bellevue Way", city: "Bellevue", state: "WA", zip: "98004", price: "$5.99", image: "cvs.jpeg", availability: "Out of Stock" }, // CVS Out of Stock
    { company: "CVS", address: "33520 21st Ave SW", city: "Federal Way", state: "WA", zip: "98023", price: "$5.99", image: "cvs.jpeg", availability: "In Stock" },
    { company: "Fred Meyer", address: "17801 108th Ave SE", city: "Renton", state: "WA", zip: "98055", price: "$4.99", image: "fred_meyer.jpg", availability: "Out of Stock" }, // Fred Meyer Out of Stock
    { company: "Fred Meyer", address: "14300 1St Ave S", city: "Burien", state: "WA", zip: "98168", price: "$4.99", image: "fred_meyer.jpg", availability: "In Stock" },
    { company: "Fred Meyer", address: "1000 164th St SW", city: "Lynnwood", state: "WA", zip: "98087", price: "$4.99", image: "fred_meyer.jpg", availability: "In Stock" }, // New Fred Meyer Entry
    { company: "Qfc", address: "200 S 3rd St", city: "Renton", state: "WA", zip: "98057", price: "$6.49", image: "Qfc.png", availability: "In Stock" },
    { company: "Qfc", address: "27035 Pacific Hwy S", city: "Des Moines", state: "WA", zip: "98198", price: "$6.49", image: "Qfc.png", availability: "In Stock" }, // New QFC Entry
    { company: "Qfc", address: "4800 NE 4th St", city: "Renton", state: "WA", zip: "98059", price: "$6.49", image: "Qfc.png", availability: "Out of Stock" }, // QFC Out of Stock
    { company: "Qfc", address: "17847 1st Ave S", city: "Normandy Park", state: "WA", zip: "98148", price: "$6.49", image: "Qfc.png", availability: "In Stock" },
    { company: "Safeway", address: "200 S 3rd St", city: "Renton", state: "WA", zip: "98057", price: "$6.49", image: "safewayPharmacy.jpg", availability: "Out of Stock" }, // Safeway Out of Stock
    { company: "Safeway", address: "20830 108th Ave SE", city: "Kent", state: "WA", zip: "98031", price: "$6.49", image: "safewayPharmacy.jpg", availability: "In Stock" },
    { company: "Safeway", address: "14300 1st Ave S", city: "Burien", state: "WA", zip: "98168", price: "$6.49", image: "safewayPharmacy.jpg", availability: "In Stock" }, // New Safeway Entry
    { company: "Safeway", address: "1000 164th St SW", city: "Lynnwood", state: "WA", zip: "98087", price: "$6.49", image: "safewayPharmacy.jpg", availability: "In Stock" }, // New Safeway Entry
    { company: "Safeway", address: "27035 Pacific Hwy S", city: "Des Moines", state: "WA", zip: "98198", price: "$6.49", image: "safewayPharmacy.jpg", availability: "In Stock" }, // New Safeway Entry
    { company: "Target", address: "301 Strander Blvd", city: "Tukwila", state: "WA", zip: "98188", price: "$4.99", image: "target.jpeg", availability: "In Stock" },
    { company: "Target", address: "4053 Factoria Square Mall SE", city: "Bellevue", state: "WA", zip: "98006", price: "$4.99", image: "target.jpeg", availability: "In Stock" }, // New Target Entry
    { company: "Walgreens", address: "25605 104TH AVE SE", city: "Kent", state: "WA", zip: "98030", price: "$6.99", image: "walgreen.jpg", availability: "In Stock" },
    { company: "Walgreens", address: "6300 E Lake Sammamish Pkwy SE", city: "Issaquah", state: "WA", zip: "98029", price: "$6.99", image: "walgreen.jpg", availability: "In Stock" }, // New Walgreens Entry
    { company: "Walgreens", address: "3716 S 144th St", city: "Tukwila", state: "WA", zip: "98168", price: "$6.99", image: "walgreen.jpg", availability: "In Stock" }, // New Walgreens Entry
    { company: "Walmart", address: "743 Rainier Ave S", city: "Renton", state: "WA", zip: "98057", price: "$4.47", image: "walmart.png", availability: "In Stock" },
    { company: "Walmart", address: "1200 164th St SW", city: "Lynnwood", state: "WA", zip: "98087", price: "$4.47", image: "walmart.png", availability: "In Stock" }, // New Walmart Entry
    { company: "Walmart", address: "1001 S 336th St", city: "Federal Way", state: "WA", zip: "98003", price: "$4.47", image: "walmart.png", availability: "In Stock" },
    { company: "Walmart", address: "19205 WA-410", city: "Bonney Lake", state: "WA", zip: "98391", price: "$4.47", image: "walmart.png", availability: "In Stock" }, // New Walmart Entry

  ];

  // Function to generate the HTML for the results
  function generateResults(filteredData = storeData) {
    const resultsContainer = document.getElementById("results");
    resultsContainer.innerHTML = ""; // Clear previous results

    filteredData.forEach((store) => {
      const availabilityColor = store.availability === "In Stock" ? "green" : "red";

      const resultHTML = `
        <div class="results-container">
          <div class="result-rectangle">
            <div class="store-box">
              <img src="C:/Users/isras/OneDrive/Desktop/Bellevue College/Spring 2025/CS 410 Software engineering/Final/${store.image}" alt="${store.company}">
            </div>
            <div class="infoto">
              <img src="C:/Users/isras/OneDrive/Desktop/Bellevue College/Spring 2025/CS 410 Software engineering/Final/ty.jpeg" alt="Tylenol Picture">
            </div>
            <div class="location-box">Location: ${store.address}, ${store.city}, ${store.state} ${store.zip}</div>
            <div class="availability-box" style="color: ${availabilityColor};">Availability: ${store.availability}</div>
            <div class="medicine-box">Medicine: <span class="medicineCell">Tylenol</span></div>
            <div class="price-box">Price: ${store.price}</div>
            <button onclick="addToBookmarks(${JSON.stringify(store).replace(/"/g, '&quot;')})">Bookmark</button>
          </div>
        </div>
      `;
      resultsContainer.innerHTML += resultHTML;
    });
  }

  // Function to add a store to bookmarks
  function addToBookmarks(store) {
    let bookmarks = JSON.parse(localStorage.getItem('bookmarks')) || [];
    bookmarks.push(store);
    localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
    alert('Added to bookmarks!');
  }

  // Function to filter results based on selected stores
  function filterResults() {
    const checkboxes = document.querySelectorAll('#storeCheckboxes input[type="checkbox"]');
    const allCheckbox = document.querySelector('#storeCheckboxes input[value="All"]');
    const selectedStores = Array.from(checkboxes)
      .filter(checkbox => checkbox.checked)
      .map(checkbox => checkbox.value);

    // If "All" is checked, check all other checkboxes
    if (allCheckbox.checked) {
      checkboxes.forEach(checkbox => {
        checkbox.checked = true;
      });
      generateResults(); // Show all results
    } else {
      // If "All" is unchecked, uncheck it and filter based on other selections
      const filteredData = storeData.filter((store) => selectedStores.includes(store.company));
      generateResults(filteredData); // Show filtered results
    }
  }

  // Function to handle individual checkbox behavior
  function handleIndividualCheckbox() {
    const checkboxes = document.querySelectorAll('#storeCheckboxes input[type="checkbox"]');
    const allCheckbox = document.querySelector('#storeCheckboxes input[value="All"]');

    // If any checkbox other than "All" is unchecked, uncheck "All"
    const otherCheckboxes = Array.from(checkboxes).filter(checkbox => checkbox.value !== "All");
    if (otherCheckboxes.some(checkbox => !checkbox.checked)) {
      allCheckbox.checked = false;
    }

    // If all other checkboxes are checked, check "All"
    if (otherCheckboxes.every(checkbox => checkbox.checked)) {
      allCheckbox.checked = true;
    }

    filterResults(); // Update the results
  }

  // Attach event listeners to checkboxes
  document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('#storeCheckboxes input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      if (checkbox.value === "All") {
        checkbox.addEventListener('change', filterResults); // Handle "All" checkbox
      } else {
        checkbox.addEventListener('change', handleIndividualCheckbox); // Handle individual checkboxes
      }
    });
  });

  // Call the function on page load to display all results
  window.onload = () => generateResults();
</script>

<script>
  // Toggle filter popup
  function toggleFilter() {
    const filterPopup = document.getElementById('filterPopup');
    filterPopup.style.display = filterPopup.style.display === 'none' || filterPopup.style.display === '' ? 'block' : 'none';
  }

  // Close the filter popup when clicking outside of it
  document.addEventListener('click', function (event) {
    const filterPopup = document.getElementById('filterPopup');
    const filterButton = document.querySelector('.filter-icon');

    // Check if the click is outside the filter popup and not on the filter button
    if (filterPopup.style.display === 'block' && !filterPopup.contains(event.target) && event.target !== filterButton) {
      filterPopup.style.display = 'none';
    }
  });

  // Ensure the filter popup is hidden on page load
  document.addEventListener('DOMContentLoaded', function () {
    const filterPopup = document.getElementById('filterPopup');
    filterPopup.style.display = 'none'; // Explicitly set to 'none' on page load
  });
</script>

</body>
</html>